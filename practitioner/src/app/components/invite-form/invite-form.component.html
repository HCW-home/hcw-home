<div class="invite-overlay" (click)="onCancel()">
    <div class="invite-modal" (click)="$event.stopPropagation()">

        <header class="invite-modal__header">
            <button (click)="onCancel()" class="invite-modal__close">×</button>
        </header>

        <form class="invite-modal__body" [formGroup]="form" (ngSubmit)="onSubmit()">

            <div class="form-section left">
                <h3 class="section-title">{{ modalTitle }}</h3>

                <div class="row">
                    <div class="field">
                        <label>Firstname *</label>
                        <input formControlName="firstName" />
                    </div>
                    <div class="field">
                        <label>Lastname *</label>
                        <input formControlName="lastName" />
                    </div>
                </div>

                <div class="row">
                    <div class="field">
                        <label>Gender *</label>
                        <select formControlName="gender">
                            <option value="" disabled>Choose…</option>
                            @for (g of genders; track g) {
                            <option [value]="g">{{ g }}</option>
                            }
                        </select>
                    </div>
                    <div class="field">
                        <label>Language *</label>
                        <select formControlName="language">
                            <option value="" disabled>Choose…</option>
                            @for (l of languages; track l) {
                            <option [value]="l">{{ l }}</option>
                            }
                        </select>
                    </div>
                </div>

                <div class="row">
                    <div class="field full">
                        <label>Group (Optional)</label>
                        <select formControlName="group" [disabled]="loading">
                            <option value="">{{ loading ? 'Loading groups...' : 'No group selected' }}</option>
                            @for (group of groups; track group.id) {
                            <option [value]="group.name">{{ group.name }}</option>
                            }
                        </select>
                    </div>
                </div>

                <div class="row">
                    <div class="field full">
                        <label>
                            Please enter only email or mobile number (+41 or +33) *
                        </label>
                        <input formControlName="contact" placeholder="+41…" />
                    </div>
                </div>

                <div class="row checkbox-row">
                    <label>
                        <input type="checkbox" formControlName="manualSend" />
                        I want to send the link manually
                    </label>
                </div>

                <div class="row checkbox-row">
                    <label>
                        <input type="checkbox" formControlName="planLater" />
                        Plan later
                    </label>
                </div>

                @if (isPlanLaterSelected) {
                    <div class="scheduling-section">
                        <h4>Planned on</h4>
                        
                        <div class="row">
                            <div class="field">
                                <label>Choose a date</label>
                                <input type="date" formControlName="plannedDate" />
                            </div>
                            <div class="field">
                                <label>Select Timezone</label>
                                <select formControlName="timezone">
                                    <option value="" disabled>Select timezone</option>
                                    @for (tz of timezones; track tz.code) {
                                    <option [value]="tz.code">{{ tz.name }}</option>
                                    }
                                </select>
                            </div>
                        </div>

                        <div class="row">
                            <div class="field">
                                <label>Choose a time</label>
                                <select formControlName="plannedTime">
                                    <option value="" disabled>Select time</option>
                                    @for (time of timeSlots; track time) {
                                    <option [value]="time">{{ time }}</option>
                                    }
                                </select>
                            </div>
                        </div>
                    </div>
                }
            </div>

            <div class="form-section right">
                <h3>GUESTS</h3>
                <hr />
                <div formGroupName="guests" class="checkbox-list">
                    @for (opt of guestOptions; track opt.key) {
                    <label>
                        <input type="checkbox" formControlName="{{ opt.key }}" />
                        {{ opt.label }}
                    </label>
                    }
                </div>
            </div>
        </form>

        <footer class="invite-modal__footer">
            <app-button [variant]="ButtonVariant.Outline" [size]="ButtonSize.Medium" (click)="onCancel()">
                Cancel
            </app-button>
            <app-button [variant]="ButtonVariant.Primary" [size]="ButtonSize.Medium" [type]="ButtonType.Submit"
                (click)="onSubmit()">
                {{ submitButtonText }}
            </app-button>
        </footer>
    </div>
</div>